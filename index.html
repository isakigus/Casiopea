<!DOCTYPE html>
<head>
  <title>Casiopea</title>
</head>
<html>
  <body>
    <p>Welcome to Casiopea, small utility to calculate times</p>

    <section>
      <textarea id="textInput"></textarea>
    </section>

    <section>
      <textarea
        readonly
        id="textOutput"
      ></textarea>
    </section>
  </body>

  <script>
    console.log('welcome to casiopea')
    const inputArea = document.getElementById('textInput')
    const outputArea = document.getElementById('textOutput')

    function calculate(text) {
      text = text.replace(/ /g, '')
      text = text.replace('-', '+-')

      // console.log(text)
      text = text.split(/\+/)

      let [ha, ma] = [0, 0]

      for (const el of text) {
        const [h, m] = el.split(':')

        let negative = h.includes('-')

        hi = parseInt(h)
        mi = parseInt(m)

        // console.log(hi, h)
        // console.log(mi, m)

        ha += hi
        if (negative) {
          ma -= mi
        } else {
          ma += mi
        }
      }

      ha += ~~(ma / 60)
      ma = ma % 60

      if (ma < 0) {
        ha -= 1
        ma = 60 + ma
      }

      minutes = '' + ma

      text = `${ha}:${minutes.padStart(2, '0')}`

      return text
    }

    function main(ev) {
      console.log(ev.target.value)

      const outputText = calculate(ev.target.value)

      outputArea.value = outputText
    }

    inputArea.addEventListener('keyup', main, false)
  </script>
</html>
